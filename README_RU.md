# Сайт макропрогнозов (Flask)

Готовый мини‑сайт, который **автоматически подхватывает данные из вашего Excel/CSV**, показывает их в таблице, строит **графики по выбранному показателю** и позволяет **выгружать всё в Excel**.

## Быстрый старт

### 1) Установите зависимости
```bash
python -m venv .venv
# Windows: .venv\Scripts\activate
# macOS/Linux:
source .venv/bin/activate

pip install -r requirements.txt
```

### 2) Проверьте файл конфигурации `config.yaml`
- `data_file` — путь к вашему файлу (.xlsx или .csv). По умолчанию: `data/forecast_sample.xlsx`.
- `date_column` — столбец с датой/периодом (если есть).
- `excel_sheet` — (опционально) имя листа в Excel.
- `table_page_size` — сколько строк показывать в таблице.

### 3) Запустите сайт
```bash
python app.py
```
Откройте в браузере: http://127.0.0.1:5000

Сайт **читает ваш файл на каждый запрос**. То есть достаточно **заменить файл** на новый (или обновить его содержимое) — и страница покажет свежие данные **без перезапуска**.

## Формат данных

Минимально: один столбец с датой/периодом (например, `date`) и несколько числовых столбцов — это отдельные показатели, которые появятся в выпадающем списке «Графики показателей».

Пример в `data/forecast_sample.xlsx`:
- `date` — даты кварталов
- `GDP_growth_yoy`, `CPI_inflation_yoy`, `Unemployment_rate`, `Interest_rate` — числовые ряды

> Если ваш файл имеет другие названия колонок — просто скорректируйте `config.yaml`.

## Экспорт в Excel

Кнопка **«Экспорт в Excel»** формирует `macro_forecasts_export.xlsx` из текущих данных.

## Как развернуть на сервере

1. Установите Python (3.10+).
2. Скопируйте файлы проекта на сервер.
3. Поставьте зависимости `pip install -r requirements.txt`.
4. Настройте systemd‑сервис или используйте `gunicorn`:
   ```bash
   pip install gunicorn
   gunicorn -w 2 -b 0.0.0.0:8000 app:app
   ```
5. Поставьте Nginx как обратный прокси (опционально).

## Частые вопросы

**Можно ли читать несколько листов или файлов?**  
Базово — один файл. Если нужно больше, скажите — добавлю выбор источника и агрегацию.

**Поддерживаются ли месячные/квартальные/годовые данные?**  
Да. Даты парсятся автоматически. Если это просто периоды как строки — тоже ок, будут показаны как есть.

**Хотите загрузку файла через веб‑интерфейс?**  
Легко добавить. Сейчас чтение идёт автоматически из пути `data_file`.

---

Если нужно «допилить» структуру данных, KPI‑панель, несколько графиков на одной странице, тренды с прогнозом и т. д. — скажите, расширю.
